<!-- // MOD : Advanced bbcode box for phpbb3.0.0 by leviatan21 - START -->

<script type="text/javascript">
// <![CDATA[

addEvent(window, "load", initPopUp);
addEvent(window, "resize", centerPopWin);
addEvent(window, "scroll", centerPopWin);
window.onscroll = centerPopWin;

/**
* COMMON DHTML FUNCTIONS
* These are handy functions I use all the time.
* By Seth Banks http://www.subimage.com/
* Up to date code can be found at http://www.subimage.com/dhtml/
* This code is free for you to use anywhere, just keep this comment block.
*/

/**
* X-browser event handler attachment and detachment
* TH: Switched first true to false per http://www.onlinetools.org/articles/unobtrusivejavascript/chapter4.html
*
* @argument obj - the object to attach event to
* @argument evType - name of the event - DONT ADD "on", pass only "mouseover", etc
* @argument fn - function to call
*/
function addEvent(obj, evType, fn)
{
	if (obj.addEventListener)
	{
		obj.addEventListener(evType, fn, false);
		return true;
	}
	else if (obj.attachEvent)
	{
		var r = obj.attachEvent("on"+evType, fn);
		return r;
	}
	else
	{
		return false;
	}
}

function removeEvent(obj, evType, fn, useCapture)
{
	if (obj.removeEventListener)
	{
		obj.removeEventListener(evType, fn, useCapture);
		return true;
	}
	else if (obj.detachEvent)
	{
		var r = obj.detachEvent("on"+evType, fn);
		return r;
	}
	else
	{
		alert("Handler could not be removed");
	}
}

/**
* Code below taken from - http://www.evolt.org/article/document_body_doctype_switching_and_more/17/30655/
* Modified 4/22/04 to work with Opera/Moz (by webmaster at subimage dot com)
* Gets the full width/height because it's different for most browsers.
*/
function getViewportHeight()
{
	if (window.innerHeight!=window.undefined)
	{
		return window.innerHeight;
	}
	if (document.compatMode=='CSS1Compat')
	{
		return document.documentElement.clientHeight;
	}
	if (document.body)
	{
		return document.body.clientHeight; 
	}
	return window.undefined; 
}

function getViewportWidth()
{
	var offset = 17;
	var width = null;
	if (window.innerWidth!=window.undefined)
	{
		return window.innerWidth; 
	}
	if (document.compatMode=='CSS1Compat')
	{
		return document.documentElement.clientWidth; 
	}
	if (document.body)
	{
		return document.body.clientWidth; 
	}
}

/**
* Gets the real scroll top
*/
function getScrollTop()
{
	if (self.pageYOffset) // all except Explorer
	{
		return self.pageYOffset;
	}
	else if (document.documentElement && document.documentElement.scrollTop) // Explorer 6 Strict
	{
		return document.documentElement.scrollTop;
	}
	else if (document.body) // all other Explorers
	{
		return document.body.scrollTop;
	}
}

function getScrollLeft()
{
	if (self.pageXOffset) // all except Explorer
	{
		return self.pageXOffset;
	}
	else if (document.documentElement && document.documentElement.scrollLeft) // Explorer 6 Strict
	{
		return document.documentElement.scrollLeft;
	}
	else if (document.body) // all other Explorers
	{
		return document.body.scrollLeft;
	}
}

/**
* SUBMODAL v1.5 By Seth Banks http://www.subimage.com/
* Used for displaying DHTML only popups instead of using buggy modal windows.
*
* Contributions by:
* 	Eric Angel - tab index code
* 	Scott - hiding/showing selects for IE users
*	Todd Huss - inserting modal dynamically and anchor classes
*
* Up to date code can be found at http://www.subimage.com/dhtml/subModal
* This code is free for you to use anywhere, just keep this comment block.
*/

// Popup code
var gPopupMask = null;
var gPopupContainer = null;
var gPopFrame = null;
var gReturnFunc;
var gPopupIsShown = false;
var gDefaultPage = '{T_IMAGESET_PATH}/bbcode_box/loading.html';
var gHideSelects = false;
var gReturnVal = null;

var gTabIndexes = new Array();
// Pre-defined list of tags we want to disable/enable tabbing into
var gTabbableTags = new Array("A","BUTTON","TEXTAREA","INPUT","IFRAME");	

// If using Mozilla or Firefox, use Tab-key trap.
if (!document.all)
{
	document.onkeypress = keyDownHandler;
}

/**
* Initializes popup code on load.	
*/
function initPopUp()
{
//	Add the HTML to the body
//	theBody = document.getElementsByTagName('BODY')[0];
//	popmask = document.createElement('div');
//	popmask.id = 'popupMask';
//	popcont = document.createElement('div');
//	popcont.id = 'popupContainer';
//	popcont.innerHTML = '' +
//		'<div id="popupInner">' +
//			'<div id="popupTitleBar">' +
//				'<div id="popupTitle"><a href="http://www.mssti.com/phpBB3">Advanced BBCode Box 3</a></div>' +
//				'<div id="popupControls">' +					
//					'<img src="{T_IMAGESET_PATH}/bbcode_box/images/close.gif" onclick="hidePopWin(false);" id="popCloseBox" />' +
//				'</div>' +
//			'</div>' +
//			'<iframe src="'+ gDefaultPage +'" style="width:100%;height:100%;background-color:transparent;" scrolling="auto" frameborder="0" allowtransparency="true" id="popupFrame" name="popupFrame" width="100%" height="100%"></iframe>' +
//		'</div>';
//	theBody.appendChild(popmask);
//	theBody.appendChild(popcont);

	gPopupMask = document.getElementById("popupMask");
	gPopupContainer = document.getElementById("popupContainer");
	gPopFrame = document.getElementById("popupFrame");	
	
	// check to see if this is IE version 6 or lower. hide select boxes if so maybe they'll fix this in version 7?
	var brsVersion = parseInt(window.navigator.appVersion.charAt(0), 10);
	if (brsVersion <= 6 && window.navigator.userAgent.indexOf("MSIE") > -1) {
		gHideSelects = true;
	}
}

/**
* @argument width - int in pixels
* @argument height - int in pixels
* @argument url - url to display
* @argument function - funtion to do intead url
* @argument returnFunc - function to call when returning true from the window.
* @argument showCloseBox - show the close box - default true
*/
function showPopWin(url, todoFunc, width, height, returnFunc, showCloseBox)
{
	// show or hide the window close widget
	if (showCloseBox == null || showCloseBox == true)
	{
		document.getElementById("popCloseBox").style.display = "block";
	}
	else
	{
		document.getElementById("popCloseBox").style.display = "none";
	}
	gPopupIsShown = true;
	disableTabIndexes();
	gPopupMask.style.display = "block";
	gPopupContainer.style.display = "block";
	// calculate where to place the window on screen
	centerPopWin(width, height);
	
	var titleBarHeight = parseInt(document.getElementById("popupTitleBar").offsetHeight, 10);

	gPopupContainer.style.width = width + "px";
	gPopupContainer.style.height = (height+titleBarHeight) + "px";
	
	setMaskSize();

	// need to set the width of the iframe to the title bar width because of the dropshadow
	// some oddness was occuring and causing the frame to poke outside the border in IE6
	gPopFrame.style.width = parseInt(document.getElementById("popupTitleBar").offsetWidth, 10) + "px";
	gPopFrame.style.height = (height) + "px";
	
	if ( !url )
	{
		todoFunc;
	}
	else
	{
		gPopFrame.src = url;
	}
	
	gReturnFunc = returnFunc;
	// for IE
	if (gHideSelects == true)
	{
		hideSelectBoxes();
	}
}

//var gi = 0;
function centerPopWin(width, height)
{
	if (gPopupIsShown == true)
	{
		if (width == null || isNaN(width))
		{
			width = gPopupContainer.offsetWidth;
		}
		if (height == null)
		{
			height = gPopupContainer.offsetHeight;
		}
		
		//var theBody = document.documentElement;
		var theBody = document.getElementsByTagName("BODY")[0];
		//theBody.style.overflow = "hidden";
		var scTop = parseInt(getScrollTop(),10);
		var scLeft = parseInt(theBody.scrollLeft,10);
	
		setMaskSize();
		
		//window.status = gPopupMask.style.top + " " + gPopupMask.style.left + " " + gi++;
		var titleBarHeight = parseInt(document.getElementById("popupTitleBar").offsetHeight, 10);
		var fullHeight = getViewportHeight();
		var fullWidth = getViewportWidth();
	
		gPopupContainer.style.top = (scTop + ((fullHeight - (height+titleBarHeight)) / 2)) + "px";
		gPopupContainer.style.left =  (scLeft + ((fullWidth - width) / 2)) + "px";
		//alert(fullWidth + " " + width + " " + gPopupContainer.style.left);
	}
}

/**
* Sets the size of the popup mask.
*
*/
function setMaskSize()
{
	var theBody = document.getElementsByTagName("BODY")[0];
			
	var fullHeight = getViewportHeight();
	var fullWidth = getViewportWidth();
	
	// Determine what's bigger, scrollHeight or fullHeight / width
	if (fullHeight > theBody.scrollHeight)
	{
		popHeight = fullHeight;
	}
	else
	{
		popHeight = theBody.scrollHeight;
	}
	
	if (fullWidth > theBody.scrollWidth)
	{
		popWidth = fullWidth;
	}
	else
	{
		popWidth = theBody.scrollWidth;
	}
	
	gPopupMask.style.height = popHeight + "px";
	gPopupMask.style.width = popWidth + "px";
}

/**
* @argument callReturnFunc - bool - determines if we call the return function specified
* @argument returnVal - anything - return value 
*/
function hidePopWin(callReturnFunc)
{
	gPopupIsShown = false;
	var theBody = document.getElementsByTagName("BODY")[0];
	theBody.style.overflow = "";
	restoreTabIndexes();
	if (gPopupMask == null)
	{
		return;
	}
	gPopupMask.style.display = "none";
	gPopupContainer.style.display = "none";
	if (callReturnFunc == true && gReturnFunc != null)
	{
		// Set the return code to run in a timeout.
		// Was having issues using with an Ajax.Request();
		gReturnVal = window.frames["popupFrame"].returnVal;
		window.setTimeout('gReturnFunc(gReturnVal);', 1);
	}
	gPopFrame.src = gDefaultPage;
	// display all select boxes
	if (gHideSelects == true)
	{
		displaySelectBoxes();
	}
}

/**
 * Sets the popup title based on the title of the html document it contains.
 * Uses a timeout to keep checking until the title is valid.
 */
function setPopTitle()
{
	return;
	if (window.frames["popupFrame"].document.title == null)
	{
		window.setTimeout("setPopTitle();", 10);
	}
	else
	{
		document.getElementById("popupTitle").innerHTML = window.frames["popupFrame"].document.title;
	}
}

// Tab key trap. if popup is shown and key was [TAB], suppress it.
// @argument e - event - keyboard event that caused this function to be called.
function keyDownHandler(e)
{
    if (gPopupIsShown && e.keyCode == 9)  return false;
}

// For IE.  Go through predefined tags and disable tabbing into them.
function disableTabIndexes()
{
	if (document.all)
	{
		var i = 0;
		for (var j = 0; j < gTabbableTags.length; j++)
		{
			var tagElements = document.getElementsByTagName(gTabbableTags[j]);
			for (var k = 0 ; k < tagElements.length; k++)
			{
				gTabIndexes[i] = tagElements[k].tabIndex;
				tagElements[k].tabIndex="-1";
				i++;
			}
		}
	}
}

// For IE. Restore tab-indexes.
function restoreTabIndexes()
{
	if (document.all)
	{
		var i = 0;
		for (var j = 0; j < gTabbableTags.length; j++)
		{
			var tagElements = document.getElementsByTagName(gTabbableTags[j]);
			for (var k = 0 ; k < tagElements.length; k++)
			{
				tagElements[k].tabIndex = gTabIndexes[i];
				tagElements[k].tabEnabled = true;
				i++;
			}
		}
	}
}

/**
* Hides all drop down form select boxes on the screen so they do not appear above the mask layer.
* IE has a problem with wanted select form tags to always be the topmost z-index or layer
*
* Thanks for the code Scott!
*/
function hideSelectBoxes()
{
	for(var i = 0; i < document.forms.length; i++)
	{
		for(var e = 0; e < document.forms[i].length; e++)
		{
			if(document.forms[i].elements[e].tagName == "SELECT")
			{
				document.forms[i].elements[e].style.visibility="hidden";
			}
		}
	}
}

/**
* Makes all drop down form select boxes on the screen visible so they do not reappear after the dialog is closed.
* IE has a problem with wanted select form tags to always be the topmost z-index or layer
*/
function displaySelectBoxes()
{
	for(var i = 0; i < document.forms.length; i++)
	{
		for(var e = 0; e < document.forms[i].length; e++)
		{
			if(document.forms[i].elements[e].tagName == "SELECT")
			{
				document.forms[i].elements[e].style.visibility="visible";
			}
		}
	}
}

/**
* Help line tips values
*/
var help_line2 = {
	abbc_justify	:	"{L_ABBCODE_JUSTIFY_MOVER}"	+	"{L_ABBCODE_JUSTIFY_HELP}" ,
	abbc_right		:	"{L_ABBCODE_RIGHT_MOVER}"	+	"{L_ABBCODE_RIGHT_HELP}" ,
	abbc_center		:	"{L_ABBCODE_CENTER_MOVER}"	+	"{L_ABBCODE_CENTER_HELP}" ,
	abbc_left		:	"{L_ABBCODE_LEFT_MOVER}"	+	"{L_ABBCODE_LEFT_HELP}" ,
	abbc_pre		:	"{L_ABBCODE_PRE_MOVER}"		+	"{L_ABBCODE_PRE_HELP}" ,

	abbc_sup		:	"{L_ABBCODE_SUP_MOVER}"		+	"{L_ABBCODE_SUP_HELP}" ,
	abbc_sub		:	"{L_ABBCODE_SUB_MOVER}"		+	"{L_ABBCODE_SUB_HELP}" ,

	abbc_b			:	"{L_ABBCODE_BOLD_MOVER}"	+	"{L_ABBCODE_BOLD_HELP}" ,
	abbc_i			:	"{L_ABBCODE_ITA_MOVER}"		+	"{L_ABBCODE_ITA_HELP}" ,
	abbc_u			:	"{L_ABBCODE_UNDER_MOVER}"	+	"{L_ABBCODE_UNDER_HELP}" ,
	abbc_strike		:	"{L_ABBCODE_STRIKE_MOVER}"	+	"{L_ABBCODE_STRIKE_HELP}" ,

	abbc_fade		:	"{L_ABBCODE_FADE_MOVER}"	+	"{L_ABBCODE_FADE_HELP}" ,
	abbc_grad		:	"{L_ABBCODE_GRAD_MOVER}"	+	"{L_ABBCODE_GRAD_HELP}" ,

	abbc_rtl		:	"{L_ABBCODE_RTL_MOVER}"		+	"{L_ABBCODE_RTL_HELP}" ,
	abbc_ltr		:	"{L_ABBCODE_LTR_MOVER}"		+	"{L_ABBCODE_LTR_HELP}" ,

	abbc_marqd		:	"{L_ABBCODE_MARQD_MOVER}"	+	"{L_ABBCODE_MARQD_HELP}" ,
	abbc_marqu		:	"{L_ABBCODE_MARQU_MOVER}"	+	"{L_ABBCODE_MARQU_HELP}" ,
	abbc_marqr		:	"{L_ABBCODE_MARQR_MOVER}"	+	"{L_ABBCODE_MARQR_HELP}" ,
	abbc_marql		:	"{L_ABBCODE_MARQL_MOVER}"	+	"{L_ABBCODE_MARQL_HELP}" ,

	abbc_table		:	"{L_ABBCODE_TABLE_MOVER}"	+	"{L_ABBCODE_TABLE_HELP}" ,
	
	abbc_quote		:	"{L_ABBCODE_QUOTE_MOVER}"	+	"{L_ABBCODE_QUOTE_HELP}" ,
	abbc_code		:	"{L_ABBCODE_CODE_MOVER}"	+	"{L_ABBCODE_CODE_HELP}" ,

	abbc_spoil		:	"{L_ABBCODE_SPOIL_MOVER}"	+	"{L_ABBCODE_SPOIL_HELP}" ,

	abbc_ed2k		:	"{L_ABBCODE_ED2K_MOVER}"	+	"{L_ABBCODE_ED2K_HELP}",
	abbc_url		:	"{L_ABBCODE_URL_MOVER}"		+	"{L_ABBCODE_URL_HELP}" ,
	abbc_mail		:	"{L_ABBCODE_EMAIL_MOVER}"	+	"{L_ABBCODE_EMAIL_HELP}" ,
	abbc_web		:	"{L_ABBCODE_WEB_MOVER}"		+	"{L_ABBCODE_WEB_HELP}" ,

	abbc_img		:	"{L_ABBCODE_IMG_MOVER}"		+	"{L_ABBCODE_IMG_HELP}" ,
	abbc_imgshack	: 	"{L_ABBCODE_IMGSHARK_MOVER}"+	"{L_ABBCODE_IMGSHARK_HELP}" ,

	abbc_flash		:	"{L_ABBCODE_FLASH_MOVER}"	+	"{L_ABBCODE_FLASH_HELP}" ,
	abbc_video		:	"{L_ABBCODE_VIDEO_MOVER}"	+	"{L_ABBCODE_VIDEO_HELP}" ,
	abbc_stream		:	"{L_ABBCODE_STREAM_MOVER}"	+	"{L_ABBCODE_STREAM_HELP}" ,
	abbc_ram		:	"{L_ABBCODE_RAM_MOVER}"		+	"{L_ABBCODE_RAM_HELP}" ,
	abbc_stage6		:	"{L_ABBCODE_STAGE_MOVER}"	+	"{L_ABBCODE_STAGE_HELP}" ,
	abbc_googlevid	:	"{L_ABBCODE_GVIDEO_MOVER}"	+	"{L_ABBCODE_GVIDEO_HELP}" ,
	abbc_youtube	:	"{L_ABBCODE_YOUTUBE_MOVER}"	+	"{L_ABBCODE_YOUTUBE_HELP}" ,

	abbc_listb		:	"{L_ABBCODE_LISTB_MOVER}"	+	"{L_ABBCODE_LISTB_HELP}" ,
	abbc_listm		:	"{L_ABBCODE_LISTM_MOVER}"	+	"{L_ABBCODE_LISTM_HELP}" ,
	abbc_hr			:	"{L_ABBCODE_HR_MOVER}"		+	"{L_ABBCODE_HR_HELP}" ,

	abbc_fontcolor	:	"{L_ABBCODE_TEXTC_MOVER}"	+	"{L_ABBCODE_TEXTC_HELP}" ,
	abbc_fontsize	:	"{L_ABBCODE_TEXTS_MOVER}"	+	"{L_ABBCODE_TEXTS_HELP}" ,
	abbc_fonttype	:	"{L_ABBCODE_TEXTF_MOVER}"	+	"{L_ABBCODE_TEXTF_HELP}" ,
	abbc_fonthili	:	"{L_ABBCODE_TEXTH_MOVER}"	+	"{L_ABBCODE_TEXTH_HELP}" ,
	
	abbc_cut		:	"{L_ABBCODE_CUT_MOVER}" ,
	abbc_copy		:	"{L_ABBCODE_COPY_MOVER}" ,
	abbc_paste		:	"{L_ABBCODE_PASTE_MOVER}" ,
	abbc_plain		:	"{L_ABBCODE_PLAIN_MOVER}" ,
	
	abbc_tip		:	"{L_BBCODE_STYLES_TIP}"
}

/**
* Show help line tips
*/
function helpline2(help)
{
	if (!help)
	{
		help = 'tip';
	}
	var helpbox = document.forms[form_name].helpbox;
	if ( !help_line2["abbc_" + help] )
	{
		helpbox.value = help_line[help];			//	document.getElementById('helpline').innerHTML = help_line[help] + '&nbsp;';
	}
	else
	{
		helpbox.value = help_line2["abbc_" + help]; //	document.getElementById('helpline').innerHTML = help_line2["abbc_" + help] + '&nbsp;';
	}
}

/**
* Main function
*/
var oSelect, oSelectRange, oSelectLength, copy_paste, doc;

function bbstyle2(bbcode,ftvalue)
{
	// Get client info
	var clientPC = navigator.userAgent.toLowerCase();
	
	// Get browser version
	var clientVer = parseInt(navigator.appVersion);
	
	var is_ie = ((clientPC.indexOf('msie') != -1) && (clientPC.indexOf('opera') == -1));
	var is_win = ((clientPC.indexOf('win') != -1) || (clientPC.indexOf('16bit') != -1));
	
	var txtarea = document.forms[form_name].elements[text_name];

	if ((clientVer >= 4) && is_ie && is_win)
	{
		oSelectRange = document.selection.createRange();
		oSelectLength = oSelectRange.text.length
	}
	else if (txtarea.selectionEnd && (txtarea.selectionEnd - txtarea.selectionStart > 0))
	{
		var selLength = txtarea.textLength;
		var selStart = txtarea.selectionStart;
		var selEnd = txtarea.selectionEnd;
		var scrollTop = txtarea.scrollTop;
		
		if (selEnd == 1 || selEnd == 2)
		{
			selEnd = selLength;
		}
		
		var s1 = (txtarea.value).substring(0,selStart);
		var s2 = (txtarea.value).substring(selStart, selEnd);
		var s3 = (txtarea.value).substring(selEnd, selLength);

		oSelectRange = s2;
		oSelectLength = selEnd - selStart;
	}
		
	if ( bbcode == "ABBC_justify" )
	{
		bbfontstyle("[align=justify]", "[/align]");
	}
	else if ( bbcode == "ABBC_right" )
	{
		bbfontstyle("[align=right]", "[/align]");
	}
	else if ( bbcode == "ABBC_center" )
	{
		bbfontstyle("[align=center]", "[/align]");
	}
	else if ( bbcode == "ABBC_left" )
	{
		bbfontstyle("[align=left]", "[/align]");
	}
	else if ( bbcode == "ABBC_sup" )
	{
		bbfontstyle("[sup]", "[/sup]");
	}
	else if ( bbcode == "ABBC_sub" )
	{
		bbfontstyle("[sub]", "[/sub]");
	}
	else if ( bbcode == "ABBC_bold" )
	{
		bbfontstyle("[b]", "[/b]");
	}
	else if ( bbcode == "ABBC_italic" )
	{
		bbfontstyle("[i]", "[/i]");
	}
	else if ( bbcode == "ABBC_under" )
	{
		bbfontstyle("[u]", "[/u]");
	}
	else if ( bbcode == "ABBC_strike" )
	{
		bbfontstyle("[s]", "[/s]");
	}
	else if ( bbcode == "ABBC_pre" )
	{
		bbfontstyle("[pre]", "[/pre]");
	}
	else if ( bbcode == "ABBC_fade" )
	{
		bbfontstyle("[fade]", "[/fade]");
	}
	else if ( bbcode == "ABBC_grad" )
	{
		if ( (oSelectLength < 1) || (!oSelectLength) )
		{
			alert("{L_ABBCODE_GRAD_MIN_ERROR}" + oSelectLength);
			return;
		}
		if (oSelectLength > 120)
		{
			alert("{L_ABBCODE_GRAD_MAX_ERROR}" + oSelectLength);
			return;
		}
		showPopWin('{T_IMAGESET_PATH}/bbcode_box/modalContent.html', null, 650, 150, true);
		txtarea.focus();
	}
	else if ( bbcode == "ABBC_dirrtl" )
	{	//	txtarea.dir=('rtl');
		bbfontstyle("[dir=rtl]", "[/dir]");
	}
	else if ( bbcode == "ABBC_dirltr" )
	{	//	txtarea.dir=('ltr');
		bbfontstyle("[dir=ltr]", "[/dir]");
	}
	else if ( bbcode == "ABBC_marqd" )
	{
		bbfontstyle("[marq=down]", "[/marq]");
	}
	else if ( bbcode == "ABBC_marqu" )
	{
		bbfontstyle("[marq=up]", "[/marq]");
	}
	else if ( bbcode == "ABBC_marql" )
	{
		bbfontstyle("[marq=left]", "[/marq]");
	}
	else if ( bbcode == "ABBC_marqr" )
	{
		bbfontstyle("[marq=right]", "[/marq]");
	}
	else if ( bbcode == "ABBC_table" )
	{
		/**
		* var styleT = prompt("{L_ABBCODE_TABLE_STYLE}", "");
		* var enterR = prompt("{L_ABBCODE_ROW_NUMBER}", "1");
		* var styleR = prompt("{L_ABBCODE_ROW_STYLE}", "");
		* if (!enterR) { FoundErrors += "{L_ABBCODE_ROW_ERROR}"; }
		* var enterC = prompt("{L_ABBCODE_CELL_NUMBER}", "1");
		* var styleC = prompt("{L_ABBCODE_CELL_STYLE}", "");
		* if (!enterC) { FoundErrors += "{L_ABBCODE_CELL_ERROR}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}"+FoundErrors); return; }
		* var Row = '';
		* for (var R = 0; R < parseInt(enterR); R++)
		* {
		*	Col = '';
		* 	for (var C = 0; C < parseInt(enterC); C++)
		* 	{
		* 		Col += "[td=" + styleC + "]" + "[/td]";
		* 	}
		* 	Row += "[tr=" + styleR + "]" + Col + "[/tr]\n";
		* }		
		* bbfontstyle("[table=" + styleT + "]\n" + Row + "[/table]",'');
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_TABLE_MOVER}"	, "table"					, "/table", "{L_ABBCODE_TABLE_HELP}"]		;
		url_params[1]=["{L_ABBCODE_TABLE_STYLE}"	, "{L_ABBCODE_TABLE_NOTE}"	, ""]										;
		url_params[2]=["{L_ABBCODE_ROW_NUMBER}"  	, ""						, "{L_ABBCODE_ROW_ERROR}"]					;
		url_params[3]=["{L_ABBCODE_ROW_STYLE}"  	, "{L_ABBCODE_ROW_NOTE}"	, ""]										;
		url_params[4]=["{L_ABBCODE_CELL_NUMBER}"  	, ""						, "{L_ABBCODE_CELL_ERROR}"]					;
		url_params[5]=["{L_ABBCODE_CELL_STYLE}"  	, "{L_ABBCODE_CELL_NOTE}"	, ""]										;
		showPopWin(null,generalwizards(url_params), 550, 350, true);
	}
	else if ( bbcode == "ABBC_code" )
	{
		bbfontstyle("[code]", "[/code]");
	}
	else if ( bbcode == "ABBC_quote" )
	{
		bbfontstyle("[quote]", "[/quote]");
	}
	else if ( bbcode == "ABBC_spoil" )
	{
		bbfontstyle("[spoil]", "[/spoil]");
	}
	else if ( bbcode == "ABBC_ed2k" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_ED2K_TAG}", "ed2k://");
		* var enterTITLE = prompt("{L_ABBCODE_DESC}{L_ABBCODE_ED2K_TAG}", "{L_ABBCODE_NAME}");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; }
		* if (!enterTITLE) { FoundErrors += "{L_ABBCODE_NODESC}"; } 
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_ED2K_TAG}"+FoundErrors); return; }
		* bbfontstyle("[url="+enterURL+"]"+enterTITLE, "[/url]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_ED2K_MOVER}"		, "url="				, "/url", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "ed2k://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=["{L_ABBCODE_DESC}" 		 	, "{L_ABBCODE_NAME}"	, "{L_ABBCODE_NODESC}"]						;
		showPopWin(null,generalwizards(url_params), 550, 180, true);
	}
	else if ( bbcode == "ABBC_url" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt( "{L_ABBCODE_LINK}{L_ABBCODE_URL_TAG}", "http://" );
		* var enterTITLE = prompt( "{L_ABBCODE_DESC}{L_ABBCODE_URL_TAG}", "{L_ABBCODE_NAME}", "{L_ABBCODE_NODESC}" );
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; }
		* if (!enterTITLE) { FoundErrors += "{L_ABBCODE_NODESC}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_URL_TAG}"+FoundErrors); return; }
		* bbfontstyle("[url="+enterURL+"]"+enterTITLE, "[/url]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_URL_MOVER}"		, "url="				, "/url", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=["{L_ABBCODE_DESC}"   		, "{L_ABBCODE_NAME}"	, "{L_ABBCODE_NODESC}"]						;
		showPopWin(null,generalwizards(url_params), 550, 180, true);
	}
	else if ( bbcode == "ABBC_web" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_WEB_TAG}", "http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; }
		* var enterW = prompt("{L_ABBCODE_WIDTH}", "99%" );
		* if (!enterW) { FoundErrors += "{L_ABBCODE_NOWIDTH}"; }
		* var enterH = prompt("{L_ABBCODE_HEIGHT}", "500");
		* if (!enterH) { FoundErrors += "{L_ABBCODE_NOHEIGHT}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_WEB_TAG}"+FoundErrors); return; }
		* bbfontstyle("[web width="+enterW+" height="+enterH+"]"+enterURL, "[/web]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_WEB_MOVER}"		, "web"					, "/web", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""							, ""					, ""]										;
		url_params[3]=["{L_ABBCODE_WIDTH}"  	 	, "99%"					, "{L_ABBCODE_NOWIDTH}"]					;
		url_params[4]=["{L_ABBCODE_HEIGHT}"  	 	, "500"					, "{L_ABBCODE_NOHEIGHT}"]					;
		showPopWin(null,generalwizards(url_params), 500, 200, true);
	}
	else if ( bbcode == "ABBC_email" )
	{
		/**
		* var FoundErrors = '';
		* var enterMail = prompt("{L_ABBCODE_LINK}{L_ABBCODE_EMAIL_TAG}","");
		* if (!enterMail) { FoundErrors += "{L_ABBCODE_NOLINK}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_EMAIL_TAG}"+FoundErrors); return; }
		* bbfontstyle("[email]"+enterMail, "[/email]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_EMAIL_MOVER}"	, "email="				, "/email", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=["{L_ABBCODE_DESC}"   		, "{L_ABBCODE_NAME}"	, "{L_ABBCODE_NODESC}"]						;
		showPopWin(null,generalwizards(url_params), 550, 180, true);
	}
	else if ( bbcode == "ABBC_img" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_IMG_TAG}","http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_IMG_TAG}"+FoundErrors); return; }
		* bbfontstyle("[img]"+enterURL, "[/img]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_IMG_MOVER}"		, "img"					, "/img", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""   						, ""					, ""]										;
		showPopWin(null,generalwizards(url_params), 500, 150, true);
	}
	else if ( bbcode == "ABBC_imgshack" )
	{
		showPopWin('http://imageshack.us/iframe.php?txtcolor=111111&amp;type=blank&amp;size=30', null, 350, 100, true);
	}
	else if ( bbcode == "ABBC_flash" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_FLASH_TAG}", "http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; } 
		* var enterW = prompt("{L_ABBCODE_WIDTH}", "250");
		* if (!enterW) { FoundErrors += "{L_ABBCODE_NOWIDTH}"; }
		* var enterH = prompt("{L_ABBCODE_HEIGHT}", "250");
		* if (!enterH) { FoundErrors += "{L_ABBCODE_NOHEIGHT}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_FLASH_TAG}"+FoundErrors); return; }
		* bbfontstyle("[flash width="+enterW+" height="+enterH+"]"+enterURL, "[/flash]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_FLASH_MOVER}"	, "flash"				, "/flash", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""							, ""					, ""]										;
		url_params[3]=["{L_ABBCODE_WIDTH}"   		, "250"					, "{L_ABBCODE_NOWIDTH}"]					;
		url_params[4]=["{L_ABBCODE_HEIGHT}"   		, "250"					, "{L_ABBCODE_NOHEIGHT}"]					;
		showPopWin(null,generalwizards(url_params), 500, 200, true);
	}
	else if ( bbcode == "ABBC_video" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_VIDEO_TAG}", "http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; }
		* var enterW = prompt("{L_ABBCODE_WIDTH}", "400");
		* if (!enterW) { FoundErrors += "{L_ABBCODE_NOWIDTH}"; }
		* var enterH = prompt("{L_ABBCODE_HEIGHT}", "350");
		* if (!enterH) { FoundErrors += "{L_ABBCODE_NOHEIGHT}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_VIDEO_TAG}"+FoundErrors); return; }
		* bbfontstyle("[video width="+enterW+" height="+enterH+"]"+enterURL, "[/video]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_VIDEO_MOVER}"	, "video"				, "/video", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""							, ""					, ""]										;
		url_params[3]=["{L_ABBCODE_WIDTH}"   		, "400"					, "{L_ABBCODE_NOWIDTH}"]					;
		url_params[4]=["{L_ABBCODE_HEIGHT}"   		, "350"					, "{L_ABBCODE_NOHEIGHT}"]					;
		showPopWin(null,generalwizards(url_params), 500, 200, true);
	}
	else if ( bbcode == "ABBC_stream" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_STREAM_TAG}","http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; } 
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_STREAM_TAG}"+FoundErrors); return; }
		* bbfontstyle("[stream]"+enterURL, "[/stream]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_STREAM_MOVER}"	, "stream"				, "/stream", ""]							;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""						   	, ""					, ""]										;
		showPopWin(null,generalwizards(url_params), 500, 150, true);
	}
	else if ( bbcode == "ABBC_ram" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_RAM_TAG}","http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; } 
		* var enterW = prompt("{L_ABBCODE_WIDTH}", "220");
		* if (!enterW) { FoundErrors += "{L_ABBCODE_NOWIDTH}"; }
		* var enterH = prompt("{L_ABBCODE_HEIGHT}", "140");
		* if (!enterH) { FoundErrors += "{L_ABBCODE_NOHEIGHT}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_RAM_TAG}"+FoundErrors); return; }
		* bbfontstyle("[ram width="+enterW+" height="+enterH+"]"+enterURL, "[/ram]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_RAM_MOVER}"		, "ram"					, "/ram", ""]								;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""							, ""					, ""]										;
		url_params[3]=["{L_ABBCODE_WIDTH}"  	 	, "300"					, "{L_ABBCODE_NOWIDTH}"]					;
		url_params[4]=["{L_ABBCODE_HEIGHT}" 	  	, "50"					, "{L_ABBCODE_NOHEIGHT}"]					;
		showPopWin(null,generalwizards(url_params), 500, 200, true);
	}
	else if ( bbcode == "ABBC_stage6" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_ID}{L_ABBCODE_RAM_TAG}","0");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOID}"; }
		* var enterW = prompt("{L_ABBCODE_WIDTH}", "704");
		* if (!enterW) { FoundErrors += "{L_ABBCODE_NOWIDTH}"; }
		* var enterH = prompt("{L_ABBCODE_HEIGHT}", "496");
		* if (!enterH) { FoundErrors += "{L_ABBCODE_NOHEIGHT}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_RAM_TAG}"+FoundErrors); return; }
		* bbfontstyle("[stage6 width="+enterW+" height="+enterH+"]"+enterURL, "[/stage6]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_STAGE_MOVER}"	, "stage6"				, "/stage6", ""]							;
		url_params[1]=["{L_ABBCODE_LINK}"			, "0"					, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""							, ""					, ""]										;
		url_params[3]=["{L_ABBCODE_WIDTH}"			, "704"					, "{L_ABBCODE_NOWIDTH}"]					;
		url_params[4]=["{L_ABBCODE_HEIGHT}"   		, "496"					, "{L_ABBCODE_NOHEIGHT}"]					;
		showPopWin(null,generalwizards(url_params), 500, 200, true);
	}
	else if ( bbcode == "ABBC_GVideo" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_GVIDEO_TAG}{L_ABBCODE_GVIDEO_NOTE}","http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; } 
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_GVIDEO_TAG}"+FoundErrors); return; }
		* bbfontstyle("[GVideo]"+enterURL, "[/GVideo]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_GVIDEO_MOVER}"	, "GVideo"				, "/GVideo", "{L_ABBCODE_GVIDEO_NOTE}"]		;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""							, ""					, ""]										;
		url_params[3]=[""							, ""					, ""]										;
		url_params[4]=[""							, ""					, ""]										;
		showPopWin(null,generalwizards(url_params), 500, 180, true);
	}
	else if ( bbcode == "ABBC_youtube" )
	{
		/**
		* var FoundErrors = '';
		* var enterURL = prompt("{L_ABBCODE_LINK}{L_ABBCODE_YOUTUBE_TAG}{L_ABBCODE_YOUTUBE_NOTE}","http://");
		* if (!enterURL) { FoundErrors += "{L_ABBCODE_NOLINK}"; }
		* if (FoundErrors) { alert("{L_ABBCODE_ERROR}{L_ABBCODE_YOUTUBE_TAG}"+FoundErrors); return; }
		* bbfontstyle("[youtube]"+enterURL, "[/youtube]");
		*/
		var url_params = new Array()
		url_params[0]=["{L_ABBCODE_YOUTUBE_MOVER}"	, "youtube"				, "/youtube", "{L_ABBCODE_YOUTUBE_NOTE}"]	;
		url_params[1]=["{L_ABBCODE_LINK}"			, "http://"				, "{L_ABBCODE_NOLINK}"]						;
		url_params[2]=[""							, ""					, ""]										;
		url_params[3]=[""							, ""					, ""]										;
		url_params[4]=[""							, ""					, ""]										;
		showPopWin(null,generalwizards(url_params), 500, 180, true);
	}
	else if ( bbcode == "ABBC_listb" )
	{
		bbfontstyle("[list][*]", "[/list]");
	}
	else if ( bbcode == "ABBC_listm" )
	{
		bbfontstyle("[list=1][*]", "[/list]");
	}
	else if ( bbcode == "ABBC_hr" )
	{
		bbfontstyle("[hr]", "");
	}
	else if ( bbcode == "ABBC_plain" )
	{
		if ((clientVer >= 4) && is_ie && is_win)
		{
			// Get text selection
			theSelection = document.selection.createRange().text;
			
			if (theSelection != '')
			{
				temp = theSelection;
				document.selection.createRange().text = temp.replace(/\[[^\]]*\]/gi,"");
			}
		}
		else if (txtarea.selectionEnd && (txtarea.selectionEnd - txtarea.selectionStart > 0))
		{
			var selLength = txtarea.textLength;
			var selStart = txtarea.selectionStart;
			var selEnd = txtarea.selectionEnd;
			var scrollTop = txtarea.scrollTop;
			
			if (selEnd == 1 || selEnd == 2)
			{
				selEnd = selLength;
			}
			
			var s1 = (txtarea.value).substring(0,selStart);
			var s2 = (txtarea.value).substring(selStart, selEnd);
			var s3 = (txtarea.value).substring(selEnd, selLength);

			temp = s2;
			temp = temp.replace(/\[[^\]]*\]/gi,"");
			txtarea.value = s1 + temp + s3;

			txtarea.selectionStart = selEnd + open.length + close.length;
			txtarea.selectionEnd = txtarea.selectionStart;
		}
//		txtarea.focus();
	}
	else if ( bbcode == "ABBC_cut" )
	{
		if ((clientVer >= 4) && is_ie && is_win)
		{
			// Get text selection
			theSelection = document.selection.createRange().text;
			
			if (theSelection != '')
			{
				document.selection.createRange().text = '';
			}
		}
		else if (txtarea.selectionEnd && (txtarea.selectionEnd - txtarea.selectionStart > 0))
		{
			var selLength = txtarea.textLength;
			var selStart = txtarea.selectionStart;
			var selEnd = txtarea.selectionEnd;
			var scrollTop = txtarea.scrollTop;
			
			if (selEnd == 1 || selEnd == 2)
			{
				selEnd = selLength;
			}

			txtarea.value = (txtarea.value).substring(0,selStart) + (txtarea.value).substring(selEnd, selLength);
		}
//		txtarea.focus();
	}
	else if ( bbcode == "ABBC_copy" )
	{
		if ((clientVer >= 4) && is_ie && is_win)
		{
			// Get text selection
			copy_paste = document.selection.createRange().text;			
		}
		else if (txtarea.selectionEnd && (txtarea.selectionEnd - txtarea.selectionStart > 0))
		{
			var selLength = txtarea.textLength;
			var selStart = txtarea.selectionStart;
			var selEnd = txtarea.selectionEnd;
			var scrollTop = txtarea.scrollTop;
			
			if (selEnd == 1 || selEnd == 2)
			{
				selEnd = selLength;
			}
			
			copy_paste = (txtarea.value).substring(selStart, selEnd);
		}
//		txtarea.focus();
	}
	else if ( bbcode == "ABBC_paste" )
	{
		bbfontstyle(''+copy_paste, '');
	}
	else
	{
		alert ("{L_ABBCODE_ERROR_TAG}"+bbcode);
		return;
	}
}

/**
* Dropdown Highlight Color pallette
*/
function ABBCcolorPalette()
{
	var r = 4, g = 4, b = 4;
	var numberList = new Array(6);
	var color = '';

	numberList[0] = '00';
	numberList[1] = '40';
	numberList[2] = '80';
	numberList[3] = 'BF';
	numberList[4] = 'FF';

	for (r = 4; r > -1; r--)
	{
		for (g = 4; g > -1; g--)
		{
			for (b = 4; b > -1; b--)
			{
				color = String(numberList[r]) + String(numberList[g]) + String(numberList[b]);
				document.write('<option value="' + color + '" style="background-color:#' + color + '">#' + color + '</option>');
			}
		}
	}
}

var generalwizards = function (params)
{
	theBodyHTML = '<table id="frm" align="center" border="0" cellspacing="0" cellpadding="0" valign="top" class="content">' + 
						'<tr valign="top" ><td align="center" nowrap="nowrap" colspan="2"><h2>' + params[0][0] + '</h2><p style="font-size:0.8em">' + params[0][3] + '</p></td></tr>';
	if ( params[0][1] === 'table' )
	{
					for (p=1; p<params.length; p++)
					{
						if ( !params[p][0] || ( params[p][0] == '') ) { continue; }
	theBodyHTML +=		'<tr valign="top" ><td align="left" nowrap><label>' + params[p][0]+ '</label></td><td><input type="text" id="promptbox[' + p + ']" class="promptbox" value="" size="50" /><input type="hidden" id="errorbox[' + p + ']" class="promptbox" value="' + params[p][2] + '" /><br /><span style="font-size:0.8em">' + params[p][1] + '</span><br /></td></tr>';
					}
	}
	else
	{
					for (p=1; p<params.length; p++)
					{
						if ( !params[p][0] || ( params[p][0] == '') ) { continue; }
	theBodyHTML +=		'<tr valign="top" ><td align="left" nowrap><label>' + params[p][0]+ '</label></td><td><input type="text" id="promptbox[' + p + ']" class="promptbox" value="' + params[p][1] + '" size="50" /><input type="hidden" id="errorbox[' + p + ']" class="promptbox" value="' + params[p][2] + '" /></td></tr>';
					}
	}
	theBodyHTML +=		'<tr valign="top" ><td colspan="2"><input type="hidden" id="tag_open" value="' + params[0][1] + '" /> &nbsp; <input type="hidden" id="tag_close" value="' + params[0][2] + '" /></td></tr>' +
						'<tr valign="top" ><td align="center" colspan="2"><input type="button" class="button2" value="ok" onclick="parent.win_accept(\'' + params[0][1] + '\')" /> &nbsp; <input type="button" class="button2" value="cancel" onclick="parent.win_close();" /></td></tr>' +
					'</table>';
	theBody = popupFrame.document.getElementsByTagName('BODY')[0].innerHTML = theBodyHTML;
}

function win_accept(tag)
{
		var FoundErrors = '';
		var tag_open		= ( popupFrame.document.getElementById("tag_open")				) ? popupFrame.document.getElementById("tag_open").value							: '';
		var tag_close		= ( popupFrame.document.getElementById("tag_close")				) ? popupFrame.document.getElementById("tag_close").value		 					: '';

	if ( tag === 'table' )
	{
		var styleT			= ( popupFrame.document.getElementById("promptbox[" + 1 + "]")	) ? popupFrame.document.getElementById("promptbox[" + 1 + "]").value				: '';
		
		var enterR			= ( popupFrame.document.getElementById("promptbox[" + 2 + "]")	) ? popupFrame.document.getElementById("promptbox[" + 2 + "]").value				: '';
		var enterR_error	= ( popupFrame.document.getElementById("errorbox[" + 2 + "]")	) ? popupFrame.document.getElementById("errorbox[" + 2 + "]").value					: '';
		if ( !enterR && enterR_error			) { FoundErrors += '\n' + enterR_error; }

		var styleR			= ( popupFrame.document.getElementById("promptbox[" + 3 + "]")	) ? popupFrame.document.getElementById("promptbox[" + 3 + "]").value				: '';

		var enterC			= ( popupFrame.document.getElementById("promptbox[" + 4 + "]")	) ? popupFrame.document.getElementById("promptbox[" + 4 + "]").value				: '';
		var enterC_error	= ( popupFrame.document.getElementById("errorbox[" + 4 + "]")	) ? popupFrame.document.getElementById("errorbox[" + 4 + "]").value					: '';
		if ( !enterC && enterC_error			) { FoundErrors += '\n' + enterC_error; }

		var styleC			= ( popupFrame.document.getElementById("promptbox[" + 5 + "]")	) ? popupFrame.document.getElementById("promptbox[" + 5 + "]").value				: '';

		if (FoundErrors != '' )
		{
			alert("{L_ABBCODE_ERROR}"+FoundErrors);
			return;
		}
		
		var Row = '';
		for (var R = 0; R < parseInt(enterR); R++)
		{
			Col = '';
			for (var C = 0; C < parseInt(enterC); C++)
			{
				Col += "[td=" + styleC + "]" + "[/td]";
			}
			Row += "[tr=" + styleR + "]" + Col + "[/tr]\n";
		}
		
		bbfontstyle( '[' + tag_open + '=' + styleT + "]\n" + Row + '[' + tag_close + ']', '');
	}
	else
	{

		var tag_url			= ( popupFrame.document.getElementById("promptbox[" + 1 + "]")	) ? popupFrame.document.getElementById("promptbox[" + 1 + "]").value				: '';
		var tag_url_error	= ( popupFrame.document.getElementById("errorbox[" + 1 + "]")	) ? popupFrame.document.getElementById("errorbox[" + 1 + "]").value					: '';
		if ( !tag_url && tag_url_error			) { FoundErrors += '\n' + tag_url_error; }

		var tag_desc		= ( popupFrame.document.getElementById("promptbox[" + 2 + "]")	) ? popupFrame.document.getElementById("promptbox[" + 2 + "]").value				: '';
		var tag_desc_error	= ( popupFrame.document.getElementById("errorbox[" + 2 + "]")	) ? popupFrame.document.getElementById("errorbox[" + 2 + "]").value					: '';
		if ( !tag_desc && tag_desc_error		) { FoundErrors += '\n' + tag_desc_error; }

		var tag_width		= ( popupFrame.document.getElementById("promptbox[" + 3 + "]")	) ? " width=" + popupFrame.document.getElementById("promptbox[" + 3 + "]").value	: '';
		var tag_width_error	= ( popupFrame.document.getElementById("errorbox[" + 3 + "]")	) ? popupFrame.document.getElementById("errorbox[" + 3 + "]").value					: '';
		if ( !tag_width && tag_width_error		) { FoundErrors += '\n' + tag_width_error; }

		var tag_height		= ( popupFrame.document.getElementById("promptbox[" + 4 + "]")	) ? " height=" + popupFrame.document.getElementById("promptbox[" + 4 + "]").value	: '';
		var tag_height_error= ( popupFrame.document.getElementById("errorbox[" + 4 + "]")	) ? popupFrame.document.getElementById("errorbox[" + 4 + "]").value					: '';
		if ( !tag_height && tag_height_error	) { FoundErrors += '\n' + tag_height_error; }

		if (FoundErrors != '' )
		{
			alert("{L_ABBCODE_ERROR}"+FoundErrors);
			return;
		}

		close1 = ( tag_desc || tag_desc ) ? '' : ']' ;
		close2 = ( tag_desc || tag_desc ) ? ']' : '' ;

		bbfontstyle( '[' + tag_open + tag_width + tag_height + close1 + tag_url + close2 + tag_desc + '[' + tag_close + ']', '');
	}
	win_close();
}

function win_close()
{
	window.top.hidePopWin();
}

// ]]>
</script>

	<table id="posttable" width="100%" border="1" bordercolor="#C0C0C0" style="border-collapse: collapse;" cellspacing="0" cellpadding="0" valign="top">
		<tr valign="middle" align="{S_CONTENT_FLOW_BEGIN}" height="30">
			<td background="{T_IMAGESET_PATH}/bbcode_box/images/bg.gif" valign="middle" colspan="2">
				<span style="float:right;padding:2px 5px 0 0;font-size:10px;color:#cccccc;"><a href="http://www.mssti.com/phpBB3" target="_blank"><img src="{T_IMAGESET_PATH}/bbcode_box/images/help.png"	title="Advanced BBCode Box 3" /></a></span>
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif" style="padding-left: 4px;">
				<select style="height: 21px;" class="genmed"	name="abbc_fonttype" onChange="bbfontstyle('[font=' + this.form.abbc_fonttype.options[this.form.abbc_fonttype.selectedIndex].value + ']', '[/font]'); this.form.abbc_fonttype.selectedIndex = 0" onMouseOver="helpline2('fonttype')" onMouseOut="helpline2()">
					<option selected="selected" style="background-color: #cccccc; font-weight: bold; font-style:italic;" >- {L_ABBCODE_FONT_TYPE} -</option>
					<optgroup label="- ABBC Box 3 -">
						<option style="color:black; background-color: #FFFFFF; font-family: Bradley Hand ITC;"		class="genmed"	value="Bradley Hand ITC" >Bradley Hand ITC</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Century Gothic;"		class="genmed"	value="Century Gothic" >Century Gothic</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Curlz MT;"				class="genmed"	value="Curlz MT">Curlz MT</option>
						<option style="color:black; background-color: #FFFFFF; font-family: French Script MT;"		class="genmed"	value="French Script MT">French Script MT</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Garamond;"				class="genmed"	value="Garamond">Garamond</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Garamond Bold;"			class="genmed"	value="Garamond Bold">Garamond Bold</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Goudy Stout;"			class="genmed"	value="Goudy Stout">Goudy Stout</option>
						<option style="color:black; background-color: #FFFFFF; font-family: OCR A Extended;"		class="genmed"	value="OCR A Extended">OCR A Extended</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Script MT Bold;"		class="genmed"	value="Script MT Bold">Script MT Bold</option>
					</optgroup>
					<!-- http://typetester.maratz.com/ -->
					<optgroup label="- Safe list -">
						<option style="color:black; background-color: #FFFFFF; font-family: Arial;"					class="genmed"	value="Arial">Arial</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Arial Black;"			class="genmed"	value="Arial Black">Arial Black</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Comic Sans MS;"			class="genmed"	value="Comic Sans MS">Comic Sans MS</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Courier New;"			class="genmed"	value="Courier New">Courier New</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Georgia;"				class="genmed"	value="Georgia">Georgia</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Impact;"				class="genmed"	value="Impact">Impact</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Times New Roman;"		class="genmed"	value="Times New Roman">Times New Roman</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Trebuchet MS;"			class="genmed"	value="Trebuchet MS">Trebuchet MS</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Verdana;"				class="genmed"	value="Verdana">Verdana</option>
					</optgroup>
					<optgroup label="- Win default -">
						<option style="color:black; background-color: #FFFFFF; font-family: Lucida Console;"		class="genmed"	value="Lucida Console">Lucida Console</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Lucida Sans Unicode;"	class="genmed"	value="Lucida Sans Unicode">Lucida Sans Unicode</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Microsoft Sans Serif;"	class="genmed"	value="Microsoft Sans Serif">Microsoft Sans Serif</option>
						<option style="color:black; background-color: #FFFFFF; font-family: MS Mincho;"				class="genmed"	value="MS Mincho">MS Mincho</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Palatino Linotype;"		class="genmed"	value="Palatino Linotype">Palatino Linotype</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Symbol;"				class="genmed"	value="Symbol">Symbol</option>
						<option style="color:black; background-color: #FFFFFF; font-family: Tahoma;"				class="genmed"	value="Tahoma">Tahoma</option>
					</optgroup>
				</select>
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif" style="padding-left: 4px;">
				<select style="height: 21px" class="genmed"		name="abbc_fontsize" onchange="bbfontstyle('[size=' + this.form.abbc_fontsize.options[this.form.abbc_fontsize.selectedIndex].value + ']', '[/size]'); this.form.abbc_fontsize.selectedIndex = 2;" onMouseOver="helpline2('fontsize')" onMouseOut="helpline2()">
					<option selected="selected" style="background-color: #cccccc; font-weight: bold; font-style:italic;" >- {L_ABBCODE_FONT_SIZE} -</option>
					<option style="font-size:50%"	class="genmed"	value="50">{L_FONT_TINY}</option>
					<option style="font-size:85%"	class="genmed"	value="85">{L_FONT_SMALL}</option>
					<option style="font-size:100%"	class="genmed"	value="100">{L_FONT_NORMAL}</option>
					<option style="font-size:150%"	class="genmed"	value="150">{L_FONT_LARGE}</option>
					<option style="font-size:200%"	class="genmed"	value="200">{L_FONT_HUGE}</option>
					<option style="font-size:300%"	class="genmed"	value="300">{L_ABBCODE_FONT_GIANT}</option>
				</select>
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif" style="padding-left: 4px;">
				<select style="height: 21px" class="genmed"		name="abbc_fonthili" onchange="bbfontstyle('[highlight=#' + this.form.abbc_fonthili.options[this.form.abbc_fonthili.selectedIndex].value + ']', '[/highlight]'); this.form.abbc_fonthili.selectedIndex = 0;" onMouseOver="helpline2('fonthili')" onMouseOut="helpline2()">
					<option selected="selected" style="background-color: #cccccc; font-weight: bold; font-style:italic;" >- {L_ABBCODE_FONT_HILI}- </option>
					<script type="text/javascript">
					// <![CDATA[
						ABBCcolorPalette();
					// ]]>
					</script>
				</select>
				<!--
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif" style="padding-left: 4px;">
				<input type="button" class="button2" name="bbpalette" id="bbpalette" value="{L_FONT_COLOR}" onclick="change_palette();" title="{L_BBCODE_S_HELP}" />
				-->
			</td>
		</tr>
		<tr valign="middle" align="{S_CONTENT_FLOW_BEGIN}" height="30">
			<td background="{T_IMAGESET_PATH}/bbcode_box/images/bg.gif" valign="middle" colspan="2"> 
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/justify.gif"		class="postimage"	type="image"	name="abbc_justify"		onClick="bbstyle2('ABBC_justify')"	onMouseOver="helpline2('justify')"	onMouseOut="helpline2()"	title="{L_ABBCODE_JUSTIFY_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/right.gif" 		class="postimage"	type="image"	name="abbc_right"		onClick="bbstyle2('ABBC_right')"	onMouseOver="helpline2('right')"	onMouseOut="helpline2()"	title="{L_ABBCODE_RIGHT_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/center.gif"		class="postimage"	type="image"	name="abbc_center"		onClick="bbstyle2('ABBC_center')"	onMouseOver="helpline2('center')"	onMouseOut="helpline2()"	title="{L_ABBCODE_CENTER_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/left.gif"			class="postimage"	type="image"	name="abbc_left"		onClick="bbstyle2('ABBC_left')"		onMouseOver="helpline2('left')"		onMouseOut="helpline2()"	title="{L_ABBCODE_LEFT_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/preformat.gif"	class="postimage"	type="image"	name="abbc_pre"			onClick="bbstyle2('ABBC_pre')"		onMouseOver="helpline2('pre')"		onMouseOut="helpline2()"	title="{L_ABBCODE_PRE_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/sup.gif"			class="postimage"	type="image"	name="abbc_supscript"	onClick="bbstyle2('ABBC_sup')"		onMouseOver="helpline2('sup')"		onMouseOut="helpline2()"	title="{L_ABBCODE_SUP_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/sub.gif"			class="postimage"	type="image"	name="abbc_subs"		onClick="bbstyle2('ABBC_sub')"		onMouseOver="helpline2('sub')"		onMouseOut="helpline2()"	title="{L_ABBCODE_SUB_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/bold.gif"			class="postimage"	type="image"	name="abbc_bold"		onClick="bbstyle2('ABBC_bold')"		onMouseOver="helpline2('b')"		onMouseOut="helpline2()"	title="{L_ABBCODE_BOLD_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/italic.gif"		class="postimage"	type="image"	name="abbc_italic"		onClick="bbstyle2('ABBC_italic')"	onMouseOver="helpline2('i')"		onMouseOut="helpline2()"	title="{L_ABBCODE_ITA_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/under.gif"		class="postimage"	type="image"	name="abbc_under"		onClick="bbstyle2('ABBC_under')"	onMouseOver="helpline2('u')"		onMouseOut="helpline2()"	title="{L_ABBCODE_UNDER_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/strike.gif"		class="postimage"	type="image"	name="abbc_strike"		onClick="bbstyle2('ABBC_strike')"	onMouseOver="helpline2('strike')"	onMouseOut="helpline2()"	title="{L_ABBCODE_STRIKE_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/fade.gif"			class="postimage"	type="image"	name="abbc_fade"		onClick="bbstyle2('ABBC_fade')"		onMouseOver="helpline2('fade')"		onMouseOut="helpline2()"	title="{L_ABBCODE_FADE_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/grad.gif"			class="postimage"	type="image"	name="abbc_grad"		onClick="bbstyle2('ABBC_grad')"		onMouseOver="helpline2('grad')"		onMouseOut="helpline2()"	title="{L_ABBCODE_GRAD_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/rtl.gif"			class="postimage"	type="image"	name="abbc_dirrtl"		onClick="bbstyle2('ABBC_dirrtl')"	onMouseOver="helpline2('rtl')"		onMouseOut="helpline2()"	title="{L_ABBCODE_RTL_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/ltr.gif"			class="postimage"	type="image"	name="abbc_dirltr"		onClick="bbstyle2('ABBC_dirltr')"	onMouseOver="helpline2('ltr')"		onMouseOut="helpline2()"	title="{L_ABBCODE_LTR_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/marqd.gif"		class="postimage"	type="image"	name="abbc_marqd"		onClick="bbstyle2('ABBC_marqd')"	onMouseOver="helpline2('marqd')"	onMouseOut="helpline2()"	title="{L_ABBCODE_MARQD_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/marqu.gif"		class="postimage"	type="image"	name="abbc_marqu"		onClick="bbstyle2('ABBC_marqu')"	onMouseOver="helpline2('marqu')"	onMouseOut="helpline2()"	title="{L_ABBCODE_MARQU_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/marql.gif"		class="postimage"	type="image"	name="abbc_marql"		onClick="bbstyle2('ABBC_marql')"	onMouseOver="helpline2('marql')"	onMouseOut="helpline2()"	title="{L_ABBCODE_MARQL_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/marqr.gif"		class="postimage"	type="image"	name="abbc_marqr"		onClick="bbstyle2('ABBC_marqr')"	onMouseOver="helpline2('marqr')"	onMouseOut="helpline2()"	title="{L_ABBCODE_MARQR_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/table.gif"		class="postimage"	type="image"	name="abbc_table"		onClick="bbstyle2('ABBC_table')"	onMouseOver="helpline2('table')"	onMouseOut="helpline2()"	title="{L_ABBCODE_TABLE_MOVER}" />
			</td>
		</tr>
		<tr valign="middle" align="{S_CONTENT_FLOW_BEGIN}" height="30">
			<td background="{T_IMAGESET_PATH}/bbcode_box/images/bg.gif" valign="middle" colspan="2">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/code.gif"			class="postimage"	type="image"	name="abbc_code"		onClick="bbstyle2('ABBC_code')"		onMouseOver="helpline2('code')"		onMouseOut="helpline2()"	title="{L_ABBCODE_CODE_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/quote.gif"		class="postimage"	type="image"	name="abbc_quote"		onClick="bbstyle2('ABBC_quote')"	onMouseOver="helpline2('quote')"	onMouseOut="helpline2()"	title="{L_ABBCODE_QUOTE_MOVER}" />
				<!-- IF S_BBCODE_QUOTE -->
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/spoil.gif"		class="postimage"	type="image"	name="abbc_spoil"		onClick="bbstyle2('ABBC_spoil')"	onMouseOver="helpline2('spoil')"	onMouseOut="helpline2()"	title="{L_ABBCODE_SPOIL_MOVER}" />
				<!-- ENDIF -->
				<!-- IF S_LINKS_ALLOWED -->
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/emule.gif"		class="postimage"	type="image"	name="abbc_ed2k"		onClick="bbstyle2('ABBC_ed2k')"		onMouseOver="helpline2('ed2k')"		onMouseOut="helpline2()"	title="{L_ABBCODE_ED2K_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/url.gif"			class="postimage"	type="image"	name="abbc_url"			onClick="bbstyle2('ABBC_url')"		onMouseOver="helpline2('url')"		onMouseOut="helpline2()"	title="{L_ABBCODE_URL_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/email.gif"		class="postimage"	type="image"	name="abbc_email"		onClick="bbstyle2('ABBC_email')"	onMouseOver="helpline2('mail')"		onMouseOut="helpline2()"	title="{L_ABBCODE_EMAIL_MOVER}" />
<!-- -->		<img src="{T_IMAGESET_PATH}/bbcode_box/images/web.gif"			class="postimage"	type="image"	name="abbc_web"			onClick="bbstyle2('ABBC_web')"		onMouseOver="helpline2('web')"		onMouseOut="helpline2()"	title="{L_ABBCODE_WEB_MOVER}" />	<!-- -->
				<!-- ENDIF -->
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<!-- IF S_BBCODE_IMG -->
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/img.gif"			class="postimage"	type="image"	name="abbc_img"			onClick="bbstyle2('ABBC_img')"		onMouseOver="helpline2('img')"		onMouseOut="helpline2()"	title="{L_ABBCODE_IMG_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/imageshack.gif"	class="postimage"	type="image"	name="abbc_imgshack"	onClick="bbstyle2('ABBC_imgshack')"	onMouseOver="helpline2('imgshack')"	onMouseOut="helpline2()"	title="{L_ABBCODE_IMGSHARK_MOVER}" />
				<!-- ENDIF -->
				<!-- IF S_BBCODE_FLASH -->
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/flash.gif"		class="postimage"	type="image"	name="abbc_flash"		onClick="bbstyle2('ABBC_flash')"	onMouseOver="helpline2('flash')"	onMouseOut="helpline2()"	title="{L_ABBCODE_FLASH_MOVER}" />
				<!-- ENDIF -->
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/video.gif"		class="postimage"	type="image"	name="abbc_video"		onClick="bbstyle2('ABBC_video')"	onMouseOver="helpline2('video')"	onMouseOut="helpline2()"	title="{L_ABBCODE_VIDEO_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/sound.gif"		class="postimage"	type="image"	name="abbc_stream"		onClick="bbstyle2('ABBC_stream')"	onMouseOver="helpline2('stream')"	onMouseOut="helpline2()"	title="{L_ABBCODE_STREAM_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/ram.gif"			class="postimage"	type="image"	name="abbc_ram"			onClick="bbstyle2('ABBC_ram')"		onMouseOver="helpline2('ram')"		onMouseOut="helpline2()"	title="{L_ABBCODE_RAM_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/stage.gif"		class="postimage"	type="image"	name="abbc_stage" 		onClick="bbstyle2('ABBC_stage6')"	onMouseOver="helpline2('stage6')"	onMouseOut="helpline2()"	title="{L_ABBCODE_STAGE_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/googlevid.gif"	class="postimage"	type="image"	name="abbc_GVideo"		onClick="bbstyle2('ABBC_GVideo')"	onMouseOver="helpline2('googlevid')"onMouseOut="helpline2()"	title="{L_ABBCODE_GVIDEO_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/youtube.gif"		class="postimage"	type="image"	name="abbc_youtube"		onClick="bbstyle2('ABBC_youtube')"	onMouseOver="helpline2('youtube')"	onMouseOut="helpline2()"	title="{L_ABBCODE_YOUTUBE_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/listbullets.gif"	class="postimage"	type="image"	name="abbc_listb"		onClick="bbstyle2('ABBC_listb')"	onMouseOver="helpline2('listb')"	onMouseOut="helpline2()"	title="{L_ABBCODE_LISTB_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/listnumber.gif"	class="postimage"	type="image"	name="abbc_listm"		onClick="bbstyle2('ABBC_listm')"	onMouseOver="helpline2('listm')"	onMouseOut="helpline2()"	title="{L_ABBCODE_LISTM_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/hr.gif"			class="postimage"	type="image"	name="abbc_hr"			onClick="bbstyle2('ABBC_hr')"		onMouseOver="helpline2('hr')"		onMouseOut="helpline2()"	title="{L_ABBCODE_HR_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/cut.gif"			class="postimage"	type="image"	name="abbc_cut"			onClick="bbstyle2('ABBC_cut')"		onMouseOver="helpline2('cut')"		onMouseOut="helpline2()" 	title="{L_ABBCODE_CUT_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/copy.gif"			class="postimage"	type="image"	name="abbc_copy"		onClick="bbstyle2('ABBC_copy')"		onMouseOver="helpline2('copy')"		onMouseOut="helpline2()" 	title="{L_ABBCODE_COPY_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/paste.gif"		class="postimage"	type="image"	name="abbc_paste"		onClick="bbstyle2('ABBC_paste')"	onMouseOver="helpline2('paste')"	onMouseOut="helpline2()" 	title="{L_ABBCODE_PASTE_MOVER}" />
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/plain.gif"		class="postimage"	type="image"	name="abbc_plain"		onClick="bbstyle2('ABBC_plain')"	onMouseOver="helpline2('plain')"	onMouseOut="helpline2()" 	title="{L_ABBCODE_PLAIN_MOVER}" />
			</td>
		</tr>
		<!-- IF S_BBCODE_ALLOWED and .custom_tags -->
		<tr valign="middle" align="{S_CONTENT_FLOW_BEGIN}" height="30">
			<td background="{T_IMAGESET_PATH}/bbcode_box/images/bg.gif" valign="middle" colspan="2">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
				<!-- BEGIN custom_tags -->
				<input type="button" class="button2" name="addbbcode{custom_tags.BBCODE_ID}" value="{custom_tags.BBCODE_TAG}" onclick="bbstyle({custom_tags.BBCODE_ID})" title="{custom_tags.BBCODE_HELPLINE}" />
				<!-- END custom_tags -->
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/dots.gif"			style="padding-left: 4px;">
			</td>
		</tr>
		<!-- ENDIF -->
		<!--
		<tr>
			<td colspan="2">
				<input type="text" readonly="readonly" name="helpbox" style="width:99%" class="helpline" value="{L_STYLES_TIP}" />
			</td>
		</tr>
		-->
	</table>
	
	<div id="popupMask"></div>
	<!-- Gracient speudo pop-up - START-->
	<div id="popupContainer">
		<div id="popupInner">
			<div id="popupTitleBar">
				<img src="{T_IMAGESET_PATH}/bbcode_box/images/close.gif" onclick="hidePopWin(false);" id="popCloseBox" /><a href="http://www.mssti.com/phpBB3">Advanced BBCode Box 3</a>
			</div>
			<iframe src="{T_IMAGESET_PATH}/bbcode_box/loading.html" style="width:100%;height:100%;background-color:transparent;" scrolling="auto" frameborder="0" allowtransparency="true" id="popupFrame" name="popupFrame" width="100%" height="100%"></iframe>
		</div>
	</div>
	<!-- Gracient speudo pop-up - END-->

<!-- // MOD : Advanced bbcode box for phpbb3.0.0 by leviatan21 - END -->