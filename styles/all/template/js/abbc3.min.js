var requestRunning=!1,bbwizard;!function(e){"use strict";bbwizard=function(i,t){if(!requestRunning){var n=e("#bbcode_wizard");if(!n.is(":visible")){requestRunning=!0;var a=phpbb.loadingIndicator();e.ajax({url:i,dataType:"html",beforeSend:function(){n.hide().empty()},success:function(e){n.append(e).fadeIn("fast")},error:function(){bbfontstyle("["+t+"]","[/"+t+"]")},complete:function(){requestRunning=!1,a&&a.is(":visible")&&a.fadeOut(phpbb.alertTime)}})}}};var i=function(e,i){var t;if(is_ie&&(t=document.forms[form_name].elements[text_name],t.focus(),baseHeight=document.selection.createRange().duplicate().boundingHeight),insert_text(e+i),is_ie){var n=e+i,a=t.innerHTML.indexOf(n);if(a>0){var o=a+n.length,c=t.createTextRange();c.move("character",o),c.select(),storeCaret(t),t.focus()}}};e(document).ready(function(){var t=e("body");t.on("click",".spoilbtn",function(i){i.preventDefault();var t=e(this),n=t.closest("div").next(".spoilcontent");n.slideToggle("fast",function(){t.text(n.is(":visible")?t.data("hide"):t.data("show"))})});var n=e("#bbcode_wizard");t.on("click",function(){n.fadeOut("fast")}),n.on("click","#bbcode_wizard_submit",function(t){t.preventDefault();var a=e(this).data("bbcode");switch(a){case"url":var o=e("#bbcode_wizard_link").val(),c=e("#bbcode_wizard_description").val();i("["+a+(c.length?"="+o:"")+"]"+(c.length?c:o),"[/"+a+"]");break;case"bbvideo":i("[bbvideo]"+e("#bbvideo_wizard_link").val(),"[/bbvideo]")}n.fadeOut("fast")}).on("click","#bbcode_wizard_cancel",function(e){e.preventDefault(),n.fadeOut("fast")}).on("change","#bbvideo_wizard_sites",function(){e("#bbvideo_wizard_example").val(e(this).val())}).click(function(e){e.stopPropagation()})})}(jQuery);