<!-- IF .bbcodes -->

<!-- IF not $INCLUDEDED_TABLEDNDJS -->
	<!-- INCLUDEJS @vse_abbc3/js/tablednd.min.js -->
	<!-- DEFINE $INCLUDEDED_TABLEDNDJS = true -->
<!-- ENDIF -->

<script>

(function($) {  // Avoid conflicts with other libraries

'use strict';

$(function() {
	var msgTimer;
	var msgSuccessBox = $('<div class="successbox" style="display:none;"><img style="float:left; padding-right:8px;" src="{IMG_AJAX_IMAGE}" width="48" height="48" alt="" /><h3>{LA_INFORMATION}</h3><p>{LA_ABBC3_BBCODE_ORDERED}</p></div>').appendTo("body");

	// Re-style the sucessbox to look like a growl notification
	msgSuccessBox.css({
		'position': 'fixed',
		'top': '0',
		'right': '20px',
		'background': '#191919',
		'-moz-border-radius': '10px',
		'-webkit-border-radius': '10px',
		'border-radius': '10px',
		'-moz-box-shadow': '2px 2px 10px #000000',
		'-webkit-box-shadow': '2px 2px 10px #000000',
		'box-shadow': '2px 2px 10px #000000',
		'opacity': '0.90',
		'filter': 'alpha(opacity = 90)',
		'color': '#fff',
		'font-family': 'Verdana, Arial, sans-serif',
		'font-size': '13px',
		'padding': '10px',
		'text-shadow': '1px 1px 3px #000',
		'text-align': 'left',
		'width': '260px',
		'z-index': '50'
	});

    var bbcodeTable = $('#down');

    // Get BBCode ids from the delete button, and create tr row IDs on the fly for use by tableDnD
    bbcodeTable.find('tbody').find('tr').each(function() {
		var url = $(this).find('a').last().attr('href');
		if (url) $(this).attr('id', 'bbcode_' + url.split('bbcode=')[1]);
	});

	// Enable table row drag-drop
    bbcodeTable.tableDnD({
		onDragClass: 'row3',
		onDrop: function(table, row) {
			$.ajax({
				type: 'POST',
				url: '{UA_DRAG_DROP}&tablename=' + $(table).attr('id'),
				data: $.tableDnD.serialize(),
				success: function(res) {
					// Show the message
					if (res.success) {
						clearTimeout(msgTimer);
						msgSuccessBox.stop(true, true).hide().fadeIn(500);
						msgTimer = setTimeout(function() {
							msgSuccessBox.fadeOut(500);
						}, 3000);
					}
				}
			});
		}
	});
});

})(jQuery);

</script>

<!-- ENDIF -->
